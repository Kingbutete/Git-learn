new version of the code
